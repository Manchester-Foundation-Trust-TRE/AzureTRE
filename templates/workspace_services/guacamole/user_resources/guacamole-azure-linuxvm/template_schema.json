{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://github.com/microsoft/AzureTRE/templates/workspace_services/guacamole/user_resources/guacamole-azure-linuxvm/template_schema.json",
  "type": "object",
  "title": "Linux Virtual Machine",
  "description": "Linux virtual machine.",
  "required": [
  ],
  "authorizedRoles": [
    "WorkspaceOwner", "WorkspaceResearcher"
  ],
  "properties": {
    "os_image": {
      "$id": "#/properties/os_image",
      "type": "string",
      "title": "Linux image",
      "description": "Select Linux image to use for VM",
      "enum": [
        "Ubuntu 22.04 LTS"
      ]
    },
    "vm_size": {
      "$id": "#/properties/vm_size",
      "type": "string",
      "title": "VM Size",
      "description": "Select size of VM",
      "enum": [
        "2 CPU | 8GB RAM",
        "4 CPU | 16GB RAM",
        "8 CPU | 32GB RAM",
        "16 CPU | 64GB RAM"
      ],
      "updateable": true
    },
    "shared_storage_access": {
      "$id": "#/properties/shared_storage_access",
      "type": "boolean",
      "title": "Shared storage",
      "default": true,
      "description": "Enable access to shared storage"
    },
    "enable_shutdown_schedule": {
      "$id": "#/properties/enable_shutdown_schedule",
      "type": "boolean",
      "title": "Enable Shutdown Schedule",
      "default": false,
      "description": "Enable automatic shutdown schedule for the VM"
    },
    "shutdown_time": {
      "$id": "#/properties/shutdown_time",
      "type": "string",
      "title": "Shutdown Time",
      "description": "Time of day to shutdown the VM (HH:MM format)",
      "pattern": "^([01]?[0-9]|2[0-3]):[0-5][0-9]$"
    },
    "shutdown_timezone": {
      "$id": "#/properties/shutdown_timezone",
      "type": "string",
      "title": "Shutdown Timezone",
      "description": "Timezone for the shutdown schedule",
      "enum": [
        "UTC",
        "PST",
        "EST",
        "CST",
        "MST"
      ]
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "enable_shutdown_schedule": {
            "const": true
          }
        },
        "required": [
          "enable_shutdown_schedule"
        ]
      },
      "then": {
        "properties": {
          "shutdown_time": {
            "type": "string",
            "title": "Shutdown Time",
            "description": "Time of day to shutdown the VM (HH:MM format)",
            "pattern": "^([01]?[0-9]|2[0-3]):[0-5][0-9]$"
          },
          "shutdown_timezone": {
            "type": "string",
            "title": "Shutdown Timezone",
            "description": "Timezone for the shutdown schedule",
            "enum": [
              "UTC",
              "PST",
              "EST",
              "CST",
              "MST"
            ]
          }
        },
        "required": [
          "shutdown_time",
          "shutdown_timezone"
        ]
      }
    }
  ]
}
